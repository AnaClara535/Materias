<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Malla Curricular - Contador Público UNS</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f7f9fc;
      color: #333;
      padding: 20px;
    }
    h1 {
      text-align: center;
    }
    .year {
      margin: 20px 0;
      padding: 10px;
      background: #e0ecf8;
      border-radius: 10px;
    }
    .cuatrimestre {
      margin: 10px 0;
      padding: 10px;
      background: #dbeeff;
      border-radius: 8px;
    }
    .materia {
      margin: 5px 0;
      padding: 8px;
      border-radius: 5px;
      background: #ffffff;
      box-shadow: 0 0 4px rgba(0,0,0,0.1);
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .materia.locked {
      background: #f0f0f0;
      color: #aaa;
    }
    .materia.aprobada {
      background: #c8e6c9;
    }
    .materia .nombre {
      flex: 1;
    }
    .materia .acciones {
      margin-left: 10px;
    }
    .tooltip {
      position: relative;
      display: inline-block;
    }
    .tooltip .tooltiptext {
      visibility: hidden;
      width: 300px;
      background-color: #555;
      color: #fff;
      text-align: left;
      border-radius: 6px;
      padding: 5px;
      position: absolute;
      z-index: 1;
      bottom: 125%;
      left: 50%;
      margin-left: -150px;
      opacity: 0;
      transition: opacity 0.3s;
    }
    .tooltip:hover .tooltiptext {
      visibility: visible;
      opacity: 1;
    }
  </style>
</head>
<body>
  <h1>Malla Curricular - Contador Público (UNS)</h1>
  <div id="malla"></div>

  <script>
    const materias = [
      {
        anio: 1,
        cuatrimestres: [
          {
            nombre: "Primer Cuatrimestre",
            materias: [
              { codigo: "1660", nombre: "INTRODUCCION A LA ADMINISTRACION" },
              { codigo: "4757", nombre: "INTRODUCCION AL ESTUDIO DE LAS CIENCIAS SOCIALES" },
              { codigo: "8116", nombre: "MATEMATICA I C" }
            ]
          },
          {
            nombre: "Segundo Cuatrimestre",
            materias: [
              { codigo: "1613", nombre: "CONTABILIDAD BASICA" },
              { codigo: "9065", nombre: "INTRODUCCION AL DERECHO C.A." },
              { codigo: "8117", nombre: "MATEMATICA II C", cursada: ["8116"], aprobada: ["8116"] }
            ]
          }
        ]
      },
      {
        anio: 2,
        cuatrimestres: [
          {
            nombre: "Primer Cuatrimestre",
            materias: [
              { codigo: "1673", nombre: "ANALISIS FINANCIERO", cursada: ["8116", "8117"], aprobada: ["8116", "8117"] },
              { codigo: "9074", nombre: "DERECHO EMPRESARIO C", cursada: ["9065"], aprobada: ["9065"] },
              { codigo: "1711", nombre: "LABORATORIO DE TECNOLOGIA DE LA INFORMACION EN LAS ORGANIZACIONES", cursada: ["1660"], aprobada: ["1660"] },
              { codigo: "2360", nombre: "SISTEMAS ECONOMICOS", cursada: ["8116"], aprobada: ["8116"] }
            ]
          },
          {
            nombre: "Segundo Cuatrimestre",
            materias: [
              { codigo: "1576", nombre: "CONTABILIDAD I C.P.", cursada: ["1613"], aprobada: ["1613"] },
              { codigo: "8105", nombre: "ESTADISTICA CA", cursada: ["8116", "8117"], aprobada: ["8116", "8117"] },
              { codigo: "2253", nombre: "MICROECONOMIA", cursada: ["8117", "2360"], aprobada: ["8117", "2360", "4757"] }
            ]
          }
        ]
      }
    ];

    const aprobadas = JSON.parse(localStorage.getItem('materias_aprobadas') || '[]');

    function guardarProgreso() {
      localStorage.setItem('materias_aprobadas', JSON.stringify(aprobadas));
    }

    function crearMateria(materia) {
      const div = document.createElement('div');
      div.className = 'materia';
      const aprobada = aprobadas.includes(materia.codigo);
      const bloqueada = (materia.cursada || materia.aprobada) && !requisitosCumplidos(materia);
      if (bloqueada) div.classList.add('locked');
      if (aprobada) div.classList.add('aprobada');

      const nombre = document.createElement('span');
      nombre.className = 'nombre';
      nombre.textContent = `${materia.nombre} (${materia.codigo})`;

      const acciones = document.createElement('span');
      acciones.className = 'acciones';
      const boton = document.createElement('button');
      boton.textContent = aprobada ? '✓ Aprobada' : 'Marcar';
      boton.disabled = bloqueada;
      boton.onclick = () => {
        if (!aprobadas.includes(materia.codigo)) {
          aprobadas.push(materia.codigo);
        } else {
          const i = aprobadas.indexOf(materia.codigo);
          aprobadas.splice(i, 1);
        }
        guardarProgreso();
        renderMalla();
      };
      acciones.appendChild(boton);

      if (bloqueada) {
        const tooltip = document.createElement('div');
        tooltip.className = 'tooltip';
        tooltip.appendChild(boton);
        const texto = document.createElement('span');
        texto.className = 'tooltiptext';
        texto.innerHTML = "<strong>Requisitos:</strong><br>";
        if (materia.cursada) texto.innerHTML += `Cursada: ${materia.cursada.join(', ')}<br>`;
        if (materia.aprobada) texto.innerHTML += `Aprobada: ${materia.aprobada.join(', ')}`;
        tooltip.appendChild(texto);
        acciones.appendChild(tooltip);
      }

      div.appendChild(nombre);
      div.appendChild(acciones);
      return div;
    }

    function requisitosCumplidos(materia) {
      const cursadaOk = !materia.cursada || materia.cursada.every(c => aprobadas.includes(c));
      const aprobadaOk = !materia.aprobada || materia.aprobada.every(a => aprobadas.includes(a));
      return cursadaOk && aprobadaOk;
    }

    function renderMalla() {
      const container = document.getElementById('malla');
      container.innerHTML = '';
      for (const año of materias) {
        const divAño = document.createElement('div');
        divAño.className = 'year';
        const titulo = document.createElement('h2');
        titulo.textContent = `Año ${año.anio}`;
        divAño.appendChild(titulo);
        for (const cuatri of año.cuatrimestres) {
          const divCuatri = document.createElement('div');
          divCuatri.className = 'cuatrimestre';
          const subtitulo = document.createElement('h3');
          subtitulo.textContent = cuatri.nombre;
          divCuatri.appendChild(subtitulo);
          for (const mat of cuatri.materias) {
            divCuatri.appendChild(crearMateria(mat));
          }
          divAño.appendChild(divCuatri);
        }
        container.appendChild(divAño);
      }
    }

    renderMalla();
  </script>
</body>
</html>

    render();
  </script>
</body>
</html>
