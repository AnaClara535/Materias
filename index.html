<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Malla Curricular - Contador Público UNS</title>
  <style>
    body {
      font-family: sans-serif;
      margin: 0;
      background: #f8f9fa;
      padding: 1rem;
    }
    h1 {
      text-align: center;
      color: #3d3d3d;
    }
    .year {
      background: #e3f2fd;
      margin: 1rem 0;
      border-radius: 0.5rem;
      padding: 1rem;
    }
    .cuatrimestre {
      margin: 1rem 0;
    }
    .materia {
      background: white;
      padding: 0.5rem;
      margin: 0.3rem 0;
      border-radius: 0.3rem;
      border-left: 5px solid #2196f3;
      cursor: pointer;
    }
    .materia.aprobada {
      text-decoration: line-through;
      background: #c8e6c9;
    }
    .materia.locked {
      opacity: 0.5;
      pointer-events: none;
    }
    .tooltip {
      font-size: 0.8rem;
      color: #666;
    }
  </style>
</head>
<body>
  <h1>Malla Curricular - Contador Público (UNS)</h1>
  <div id="malla"></div>

  <script>
    const materias = [
      // AÑOS ANTERIORES (pueden estar definidos arriba)
      // Agregamos Tercer Año en adelante (según pedido del usuario)
      {
        anio: 3,
        cuatrimestre: 1,
        nombre: "ANALISIS DE SISTEMAS ADMINISTRATIVOS",
        codigo: "1558",
        cursada: ["1711"],
        rendir: ["1711"]
      },
      {
        anio: 3,
        cuatrimestre: 1,
        nombre: "CONTABILIDAD II C",
        codigo: "1643",
        cursada: ["1576"],
        rendir: ["1576", "1613"]
      },
      {
        anio: 3,
        cuatrimestre: 1,
        nombre: "CONTABILIDAD SOCIAL Y AMBIENTAL",
        codigo: "1645",
        cursada: ["1576"],
        rendir: ["1576", "1613", "1660"]
      },
      {
        anio: 3,
        cuatrimestre: 1,
        nombre: "FUNDAMENTOS DEL DERECHO PUBLICO",
        codigo: "9073",
        cursada: ["9065"],
        rendir: ["9065"]
      },
      {
        anio: 3,
        cuatrimestre: 2,
        nombre: "ACTUACION PROFESIONAL, LABORAL y PREVISIONAL",
        codigo: "1670",
        cursada: ["9074"],
        rendir: ["9074"]
      },
      {
        anio: 3,
        cuatrimestre: 2,
        nombre: "CONTABILIDAD III C",
        codigo: "1644",
        cursada: ["1643"],
        rendir: ["1643", "1576"]
      },
      {
        anio: 3,
        cuatrimestre: 2,
        nombre: "FINANZAS PUBLICAS C.P.",
        codigo: "2128",
        cursada: ["2253"],
        rendir: ["2253"]
      },
      {
        anio: 4,
        cuatrimestre: 1,
        nombre: "ACTUACION PROFESIONAL SOCIETARIA",
        codigo: "1568",
        cursada: ["9074"],
        rendir: ["9074"]
      },
      {
        anio: 4,
        cuatrimestre: 1,
        nombre: "ADMINISTRACION GENERAL C",
        codigo: "1657",
        cursada: ["1558", "1660"],
        rendir: ["1558", "1660"]
      },
      {
        anio: 4,
        cuatrimestre: 1,
        nombre: "CONTABILIDAD DE COSTOS",
        codigo: "1530",
        cursada: ["1643", "1673"],
        rendir: ["1643", "1673", "1660"]
      },
      {
        anio: 4,
        cuatrimestre: 1,
        nombre: "COOPERATIVAS, MUTUALES Y OTROS ENTES DE LA ECONOMIA SOCIAL",
        codigo: "1527",
        cursada: ["1576", "1643"],
        rendir: ["1576", "1643", "1645", "9074"]
      },
      {
        anio: 4,
        cuatrimestre: 2,
        nombre: "ADMINISTRACION FINANCIERA I",
        codigo: "1511",
        cursada: ["1643", "1644", "1673", "2128"],
        rendir: ["1643", "1644", "1673", "2128", "8105"]
      },
      {
        anio: 4,
        cuatrimestre: 2,
        nombre: "CONTABILIDAD PUBLICA",
        codigo: "1532",
        cursada: ["1643", "2128"],
        rendir: ["1643", "2128", "9073"]
      },
      {
        anio: 4,
        cuatrimestre: 2,
        nombre: "TEORIA Y TECNICA TRIBUTARIA I",
        codigo: "1911",
        cursada: ["1643", "1644"],
        rendir: ["1643", "1644", "2128", "9073", "9074"]
      },
      {
        anio: 5,
        cuatrimestre: 0,
        nombre: "AUDITORIA A",
        codigo: "1666",
        cursada: ["1568", "1657", "1911"],
        rendir: ["1568", "1657", "1911", "1644", "1670"]
      },
      {
        anio: 5,
        cuatrimestre: 1,
        nombre: "ACTUACION PROFESIONAL JUDICIAL",
        codigo: "1502",
        cursada: ["1568", "1670", "1911"],
        rendir: ["1568", "1670", "1911"]
      },
      {
        anio: 5,
        cuatrimestre: 1,
        nombre: "TEORIA Y TECNICA TRIBUTARIA II",
        codigo: "1912",
        cursada: ["1911"],
        rendir: ["1911"]
      },
      {
        anio: 5,
        cuatrimestre: 2,
        nombre: "PRACTICA PROFESIONAL INTEGRADORA",
        codigo: "1812",
        cursada: ["1568", "1912"],
        rendir: ["1568", "1912"]
      },
      {
        anio: 5,
        cuatrimestre: 2,
        nombre: "PRACTICA PROFESIONAL SUPERVISADA",
        codigo: "1813",
        rendir: ["4928"]
      },
      {
        anio: 5,
        cuatrimestre: 2,
        nombre: "PRUEBA DE SUFICIENCIA EN IDIOMA EXTRANJERO: INGLES",
        codigo: "4928"
      }
    ];

    const aprobadas = JSON.parse(localStorage.getItem("aprobadas") || "[]");

    function puedeCursar(m) {
      return !m.cursada || m.cursada.every(c => aprobadas.includes(c));
    }

    function puedeRendir(m) {
      return !m.rendir || m.rendir.every(r => aprobadas.includes(r));
    }

    function render() {
      const container = document.getElementById("malla");
      container.innerHTML = "";
      const agrupadas = {};
      materias.forEach(m => {
        const key = `${m.anio}-${m.cuatrimestre}`;
        if (!agrupadas[key]) agrupadas[key] = [];
        agrupadas[key].push(m);
      });

      Object.entries(agrupadas).forEach(([key, lista]) => {
        const [anio, cuatri] = key.split("-");
        const anioEl = document.createElement("div");
        anioEl.className = "year";
        anioEl.innerHTML = `<h2>Año ${anio} - ${cuatri == 1 ? '1º Cuatrimestre' : cuatri == 2 ? '2º Cuatrimestre' : 'Anual'}</h2>`;
        lista.forEach(m => {
          const div = document.createElement("div");
          div.className = "materia";
          div.textContent = `${m.nombre} (${m.codigo})`;
          if (!puedeCursar(m) || !puedeRendir(m)) div.classList.add("locked");
          if (aprobadas.includes(m.codigo)) div.classList.add("aprobada");
          div.onclick = () => {
            const idx = aprobadas.indexOf(m.codigo);
            if (idx >= 0) aprobadas.splice(idx, 1);
            else aprobadas.push(m.codigo);
            localStorage.setItem("aprobadas", JSON.stringify(aprobadas));
            render();
          };
          const tip = document.createElement("div");
          tip.className = "tooltip";
          if (m.cursada) tip.innerText += `Cursar si: ${m.cursada.join(", ")}\n`;
          if (m.rendir) tip.innerText += `Rendir si: ${m.rendir.join(", ")}\n`;
          div.appendChild(tip);
          anioEl.appendChild(div);
        });
        container.appendChild(anioEl);
      });
    }

    render();
  </script>
</body>
</html>
